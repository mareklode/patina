<!--?php
    $h1 = 'test';
    $headerSimple = true;
    include '_header.php' 
?-->
  
        <style>
            :root {
                --gap-width: 1rem;
                --view-background-color: white;

                --stroke-width: .5rem;
                --half-stroke-width: calc(var(--stroke-width) / 2);
                --stroke-color: gray;

                --border-radius: var(--half-stroke-width);
            }
            html, body { margin: 0 }
            .pattern__thumbnail { float: left; margin: 0; line-height: 64px; color: purple; text-align: center; }

            .view {
                margin: 0 auto;
                width: fit-content;
                background-color: var(--view-background-color);
            }
            .family {
                display: grid;
                grid-template-columns: auto auto;
                grid-template-rows: auto auto;
                grid-template-areas: 
                "parent parent"
                "child child"
                ;
                gap: calc(2 * var(--gap-width)) var(--gap-width);
                
                background-color: transparent;
            }
            .child {
                grid-area: child;
                min-height: 200px;                

                position: relative; /* to position the :after-markers */

                &::before { /* marker on top */
                    display: block;
                    content: "";
                    height: var(--gap-width);
                    width: var(--stroke-width);
                    transform: translateX(var(--half-stroke-width));
                    background-color: var(--stroke-color);
                    position: absolute;
                    top: calc(var(--gap-width) * -1);
                    right: 50%;
                }
            }
            .parent {
                min-height: 200px;

                display: grid;
                align-items: end;

                position: relative; /* to position the bracket below */

                /* bracket below is a rectangle with 2 visible borders */
                &::after { 
                    display: block;
                    content: "";
                    width: calc(50% + var(--gap-width));
                    height: calc(var(--gap-width) - var(--half-stroke-width));
                    border: 0 solid var(--stroke-color);
                    position: absolute;
                    bottom: calc(-1 * calc(var(--gap-width) + var(--half-stroke-width)));
                    background-color: transparent;
                    
                    /* left part of the bracket */
                    right: calc(calc(0px - var(--gap-width)) - var(--half-stroke-width));

                    border-width: 0 0 var(--stroke-width) var(--stroke-width);
                    border-bottom-left-radius: calc(2 * var(--stroke-width));
                }

                /* right part of the bracket .parent + .parent:after */
                + .parent::after {
                    right: unset;
                    left: calc(calc(0px - var(--gap-width)) - var(--half-stroke-width));

                    border-width: 0 var(--stroke-width) var(--stroke-width) 0;
                    border-bottom-left-radius: unset;
                    border-bottom-right-radius: calc(2 * var(--stroke-width));
                }
            }
            .patina-node {
                width: 200px;
                margin: 0 auto;
                background: darkslategray;
                min-height: 200px;
                border-radius: var(--border-radius);
            }
        </style>

        <div class="view">
            <div class="family">
                <div class="parent">
                    <div class="family">
                        <div class="parent">
                            <div class="patina-node">x</div>
                        </div>
                        <div class="parent">
                            <div class="family">
                                <div class="parent">
                                    <div class="patina-node">x</div>
                                </div>
                                <div class="parent">
                                    <div class="patina-node">x</div>
                                </div>
                                <div class="child">
                                    <div class="patina-node">x</div>
                                </div>
                            </div>
                        </div>
                        <div class="child">
                            <div class="patina-node">x</div>
                        </div>
                    </div>        
                </div>
                <div class="parent">
                    <div class="patina-node">x</div>
                </div>
                <div class="child">
                    <div class="patina-node">x</div>
                </div>
            </div>
        </div>

        <!--div class="pattern">
            <div class="js-module pattern__thumbnail pattern__thumbnail--512" 
                style="background-color: #7d9cb1; height: 100vh; width: 100%;"
                data-module-name="patina" 
                data-module-data='{
                    "width"          : 512,
                    "height"         : 512,
                    "patina": {
                        "type"  : "combine",
                        "combineMode" : { 
                            "name"      : "add",
                            "opacity"   : 0.5
                        },
                        "topLayer"      : {
                            "type"  : "createPattern",
                            "patternName": "random_walker",
                            "impact": 0.1
                        },
                        "bottomLayer" : {
                            "type"  : "combine",
                            "combineMode" : { 
                                "name"      : "add",
                                "opacity"   : 0.075
                            },
                            "topLayer"      : {
                                "type"  : "createPattern",
                                "patternName": "labyrinth",
                                "color": 1
                            },
                            "bottomLayer" : {
                                "type"  : "colorChannels",
                                "red"   : {
                                    "type"  : "combine",
                                    "combineMode" : { 
                                        "name": "add",
                                        "opacity": 0.15
                                    },
                                    "topLayer"      : {
                                        "type"          : "createPattern",
                                        "patternName"   : "noise_white"
                                    },
                                    "bottomLayer"   : {
                                        "type"      : "createPattern",
                                        "pattern"   : {
                                            "name"      : "slope",
                                            "direction" : "to bottom",
                                            "colorBegin": 0,
                                            "colorEnd"  : 90
                                        }
                                    }
                                },                        
                                "green" : {
                                    "type"  : "combine",
                                    "combineMode" : { 
                                        "name": "add",
                                        "opacity": 0.075
                                    },
                                    "topLayer"      : {
                                        "type"          : "createPattern",
                                        "patternName"   : "noise_white",
                                        "filter"        : [
                                            { "name": "contrast", "m": 1, "x": 0.5 }
                                        ]
                                    },
                                    "bottomLayer"   : {
                                        "type"      : "createPattern",
                                        "pattern"   : {
                                            "name"      : "slope",
                                            "direction" : "to bottom",
                                            "colorBegin": 25,
                                            "colorEnd"  : 15
                                        }
                                    }
                                },
                                "blue"  : {
                                    "type"  : "combine",
                                    "combineMode" : { 
                                        "name": "add",
                                        "opacity": 0.15
                                    },
                                    "topLayer"      : {
                                        "type"          : "createPattern",
                                        "patternName"   : "noise_white"
                                    },
                                    "bottomLayer"   : {
                                        "type"      : "createPattern",
                                        "pattern"   : {
                                            "name"      : "slope",
                                            "direction" : "to right",
                                            "colorBegin": 0,
                                            "colorEnd"  : 150
                                        }
                                    }
                                },
                                "alpha" : 255
                            }
                        }
                    }
                }'
            ></div>
        </div-->
    </main>

    <script type="module" src="scripts/main.js"></script>

</body>
</html>
